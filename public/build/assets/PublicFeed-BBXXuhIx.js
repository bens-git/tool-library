import{P as z}from"./PageLayout-D-q0Jw-F.js";import{o as T,r as a,b as v,w as r,d as n,u as x,h as j,e as o,j as l,f as w,p as k,m as _,F as A,z as I,t as c,B as M,a as y,A as W,i as d}from"./app-Cl7cSYny.js";import"./loading-B-pAuaq2.js";import"./response-BrJijees.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"d-flex justify-end mt-2"},G={key:1,class:"text-center py-8"},H={key:2,class:"text-center py-8"},J={class:"d-flex align-center mb-3"},K={class:"text-white"},O={class:"font-weight-bold"},Q={class:"text-grey"},R={class:"text-body-1"},st={__name:"PublicFeed",setup(X){const P=M().props.auth.user,u=d([]),i=d(""),m=d(!1),p=d(!1),f=async()=>{m.value=!0;try{const e=await y.get(route("messages.public"));u.value=e.data.data}catch(e){console.error("Error fetching posts:",e)}finally{m.value=!1}},C=async()=>{if(i.value.trim()){p.value=!0;try{await y.post(route("messages.public.create"),{body:i.value}),await f(),i.value=""}catch(e){console.error("Error creating post:",e)}finally{p.value=!1}}},V=async()=>{try{await y.post(route("messages.community.visited")),await new Promise(e=>setTimeout(e,100)),W.reload({only:["notifications"]})}catch(e){console.error("Error marking community visited:",e)}},B=e=>{const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},F=e=>e?e.charAt(0).toUpperCase():"?";return T(()=>{f(),V()}),(e,t)=>{const N=a("v-textarea"),D=a("v-btn"),g=a("v-card"),E=a("v-progress-circular"),L=a("v-icon"),S=a("v-avatar"),U=a("v-container");return l(),v(z,null,{default:r(()=>[n(x(j),{title:"Community Feed"}),n(U,{fluid:"",class:"pa-4",style:{"max-width":"800px",margin:"0 auto"}},{default:r(()=>[t[6]||(t[6]=o("div",{class:"text-h4 font-weight-bold mb-4"},"Community Feed",-1)),x(P)?(l(),v(g,{key:0,class:"mb-6 pa-4"},{default:r(()=>[t[2]||(t[2]=o("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Share something with the community",-1)),n(N,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),placeholder:"What's on your mind?",variant:"outlined",rows:"3","hide-details":""},null,8,["modelValue"]),o("div",q,[n(D,{color:"primary",loading:p.value,disabled:!i.value.trim(),onClick:C},{default:r(()=>[...t[1]||(t[1]=[w(" Post ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})):k("",!0),m.value?(l(),_("div",G,[n(E,{indeterminate:"",color:"primary"})])):u.value.length===0?(l(),_("div",H,[n(L,{size:"64",color:"grey"},{default:r(()=>[...t[3]||(t[3]=[w("mdi-post-outline",-1)])]),_:1}),t[4]||(t[4]=o("div",{class:"text-h6 mt-2"},"No posts yet",-1)),t[5]||(t[5]=o("div",{class:"text-body-2 text-grey"},"Be the first to share something!",-1))])):k("",!0),(l(!0),_(A,null,I(u.value,s=>(l(),v(g,{key:s.id,class:"mb-4 pa-4"},{default:r(()=>{var h;return[o("div",J,[n(S,{color:"primary",size:"40",class:"mr-3"},{default:r(()=>{var b;return[o("span",K,c(F((b=s.user)==null?void 0:b.name)),1)]}),_:2},1024),o("div",null,[o("div",O,c(((h=s.user)==null?void 0:h.name)||"Unknown"),1),o("small",Q,c(B(s.created_at)),1)])]),o("div",R,c(s.body),1)]}),_:2},1024))),128))]),_:1})]),_:1})}}};export{st as default};
