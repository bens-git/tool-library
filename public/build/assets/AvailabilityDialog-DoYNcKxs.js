import{a as m}from"./api-DLStZGrk.js";import{C as N,r as a,b as c,w as o,j as s,d as l,p as v,f as d,m as b,F as j,z as E,t as $,D as q,E as M,i as P}from"./app-CNC4IMbH.js";import"./loading-CNBH5LN6.js";const R={key:2},K={__name:"AvailabilityDialog",props:{item:{type:Object,required:!0}},setup(f){const u=M(!1),e=P(null),k=f;N(u,n=>{n&&_()});const y=async()=>{e.value=await m.get(route("items.index",k.item.id))},D=async()=>{if(await y(),e.value.id)try{const n=await m.get(route("item.index-unavailable-dates",e.value.id));e.value.unavailableDates=n}catch(n){console.error("Failed to fetch unavailable dates:",n)}},_=async()=>{D()},g=async()=>{(await m.get(route("items.update",e.value))).success&&(u.value=!1)},w=n=>{n>=0&&n<e.value.unavailableDates.length&&e.value.unavailableDates.splice(n,1)};return(n,t)=>{const r=a("v-btn"),V=a("v-checkbox"),x=a("v-date-input"),C=a("v-alert"),I=a("v-icon"),S=a("v-chip"),U=a("v-col"),O=a("v-row"),h=a("v-card-text"),z=a("v-divider"),A=a("v-spacer"),B=a("v-card-actions"),F=a("v-card"),L=a("v-dialog");return s(),c(L,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=i=>u.value=i),onOpen:_},{activator:o(({props:i})=>[l(r,q({color:"primary","prepend-icon":"mdi-calendar",text:"Item Availability",variant:"tonal"},i,{block:"",size:"small"}),null,16)]),default:o(()=>[e.value?(s(),c(F,{key:0,"prepend-icon":"mdi-calendar",title:"Item Availability"},{default:o(()=>[l(h,null,{default:o(()=>[l(V,{modelValue:e.value.make_item_unavailable,"onUpdate:modelValue":t[0]||(t[0]=i=>e.value.make_item_unavailable=i),label:"Make item unavailable",density:"compact","true-value":1,"false-value":0},null,8,["modelValue"]),e.value.make_item_unavailable?v("",!0):(s(),c(x,{key:0,modelValue:e.value.unavailableDates,"onUpdate:modelValue":t[1]||(t[1]=i=>e.value.unavailableDates=i),label:"Select Unavailable Dates",min:new Date().toISOString().substr(0,10),multiple:""},null,8,["modelValue","min"])),e.value.make_item_unavailable?(s(),c(C,{key:1,color:"error"},{default:o(()=>[...t[4]||(t[4]=[d("Unavailable",-1)])]),_:1})):v("",!0),e.value.unavailableDates&&e.value.unavailableDates.length&&!e.value.make_item_unavailable?(s(),b("div",R,[l(O,null,{default:o(()=>[(s(!0),b(j,null,E(e.value.unavailableDates,(i,p)=>(s(),c(U,{key:p,cols:"4"},{default:o(()=>[l(S,{class:"ma-2",color:"red lighten-2"},{default:o(()=>[d($(new Date(i).toLocaleDateString())+" ",1),l(r,{icon:"",small:"",onClick:T=>w(p)},{default:o(()=>[l(I,null,{default:o(()=>[...t[5]||(t[5]=[d("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):v("",!0)]),_:1}),l(z),l(B,null,{default:o(()=>[l(A),l(r,{text:"Cancel",variant:"plain",onClick:t[2]||(t[2]=i=>u.value=!1)}),l(r,{color:"success",text:"Save",variant:"tonal",onClick:g})]),_:1})]),_:1})):v("",!0)]),_:1},8,["modelValue"])}}};export{K as default};
